# 1.1 인터넷이란 무엇인가
## 1.1.1 구성요소로 본 인터넷
- 인터넷에 연결되는 모든 장치를 호스트(host), 혹은 종단 시스템(end system)이라고 부른다.
- 종단 시스템은 communication link 와 packet switch로 연결된다.
- 한 종단 시스템이 다른 종단시스템으로 보낼 데이터를 갖고 있을 때 송신 종단 시스템은 그 데이터를 segment로 나누고 각 segment에 header를 붙인다. 이렇게 만들어진 정보 패키지를 packet이라고 부른다. 
- packet은 네트워크를 통해 보내지고 목적지에서 원래의 데이터로 다시 조립된다.
- 오늘날 가장 널리 사용되는 두 가지 종류의 패킷 스위치: 라우터, 링크 계층 스위치 
  - 패킷스위치는 최종 목적지 방향으로 채킷을 전달한다. 
  - 라우터: 보통 접속 네트워크에서 사용
  - 링크 계층 스위치: 네트워크 코어에서 사용
- 종단 시스템은 [ISP](https://github.com/kormk/Computer_Network/blob/main/acronym.md)를 통해 인터넷에 접속한다.
- 인터넷은 종단 시스템을 서로 연결하는 것이므로 [ISP](https://github.com/kormk/Computer_Network/blob/main/acronym.md)들도 서로 연결되어야만 한다.
- 인터넷의 다른 구성요소는 인터넷에서 정보 송수신을 제어하는 여러 프로토콜을 수행한다. 
- 각각의 프로토콜이 무엇을 수행하는지에 대해 합의하는 것도 매우 중요하다.(ex. IETF의 RFC)

## 1.1.2 서비스 측면에서 본 인터넷
- 애플리케이션에 서비스를 제공하는 인프라스트럭쳐로서 인터넷을 기술할 수 있다.
- 인터넷 애플리케이션은 종단 시스템에서 수행된다.(네트워크 코어에 있는 패킷 교환기에서 수행되지 않는다.)
  
## 1.1.3 프로토콜
- 명확하게 송수신된 메시지와 이러한 메세지가 송수신될 때나 다른상황이 발생했을 때 취하는 행동
- 네트워크 프로토콜
  - 통신하는 둘 이상의 원격 개체가 포함된 인터넷에서의 모든 활동은 프로토콜이 제어한다.


# 1.2 네트워크의 가장자리
## 1.2.1 접속 네트워크 
- 가정접속: DSL, 케이블, FTTH, 5G, 고정무선  
    ```
        DSL: 기존의 전화회선으로 인터넷 제공
        FTTH: CO로 부터 가정까지 직접 광섬유 경로제공
    ```
- 기업(과 가정) 접속: 이더넷과 와이파이
- 광역 무선접속: 3G와 LTE 4G와 5G

## 1.2.2 물리매체
- 꼬임쌍선: UTP
- 동축케이블
- 광섬유
- 지상 라디오 채널
- 위성 라디오 채널

# 1.3 네트워크 코어
## 1.3.1 패킷 교환
- 네트워크 애플리케이션에서 종단시스템들은 서로 메세지(패킷)를 교환한다.
- 송신 측과 수신 측 사이에서 각 패킷은 통신링크(라우터 혹은 링크 계층 스위치)를 거치게 된다.
- 패킷은 링크의 최대 전송률과 같은 속도로 각각의 통신링크에서 전송된다.    
```
따라서 종단시스템 혹은 패킷 스위치가 R bit/sec의 속도로 L bits의 패킷을 전송한다면
그 패킷을 전송하는 데 걸리는 시간은 L/R초이다.
```
    
### Store and Foward
- 스위치가 출력링크로 패킷의 첫 비트를 전송하기 전에 전체 패킷을 받아야 함을 의미  
```
출발지에서의 패킷전송 L/R초 
L/R초에 라우터가 전체 패킷을 수신하고 목적지를 향해 출력 링크로 전송
출발지와 목적지 사이에 N-1개의 라우터가 존재
따라서 종단간 지연은 N*L/R
```

### Queuing delay, packet loss
- 각 링크에 대해 패킷 스위치는 출력버퍼(출력 큐)를 갖고있다.
- 링크가 다른 패킷을 전송하고 있다면 queuing delay를 겪게된다.
- 버퍼가 가득 파 있는 경우에 패킷손실이 발생한다.


### 포워딩 테이블과 라우팅 프로토콜
출바지 종단 시스템이 패킷을 목적지 종단 시스템으로 보내고자 할 때, 
출발지는 패킷의 헤더에 목적지의 IP주소를 포함한다.
- 각 라우터는 목적지주소를 라우터의 출력 링크로 매핑하는 포워딩 테이블을 갖고 있다.
- 패킷이 라우터에 도착하면 라우터는 올바른 출려 링크를 찾기 위해 주소를 조사하고 이 목적지 주소를 이용하여 포워딩 테이블을 검색한다. 그런 후 라우터는 그 패킷을 출력 링크로 보낸다.
- (인터넷은 자동으로 포워딩 테이블을 설정하는데 이용되는 여러가지의 라우팅 프로토콜을 가지고있다.)

## 1.3.2 회선교환
회선 교환 네트워크에서 종단 시스템 간에 통신을 제공하기 위해 경로상에 필요한 자원은 통신 세션 동안에 확보 또는 예약된다.
- 세션 메시지는 on-demand 방식으로 자원을 요청하여 사용하고 그 결과, 통신 링크에 대한 접속을 위해 기다릴 수도 있다.
- 네트워크가 회선을 설정할 때, 그 연결이 이루어지는 동안 네트워크 링크에 일정한 전송률을 예약한다.
- 주어진 전송률이 송신자-수신자 연결을 위해 예약되므로 보장된 일정 전송률로 데이터를 보낼 수 있다.

### 회선교환 네트워크에서의 다중화
### 주파수 분할 다중화(frequency-division multiplexing, FDM)
- 링크를 통해 설정된 연결은 그 링크의 주파수 스펙트럼을 공유한다.
- 링크는 연결되는 동안 각 연결에 대해 주파수 대역을 고정 제공한다. (이런 대역의 폭을 대역폭이라 한다.)
### 시 분할 다중화(time-division multiplexing, TDM)
- 시간을 일정 주기의 프레임으로 구분하고 각 프레임은 고정된 수의 시간 슬롯으로 나뉜다.
- 네트워크가 링크를 통해 하나의 연결을 설정할 때, 네트워크는 모든프레임에서 시간슬롯 1개를 그 연결에 할당한다.

### 패킷 교환 대 회선 교환
```
나의 생각
: 회선 교환의 경우는 네트워크 자원을 예약하여 사용하기 때문에 소수의 사용자 만을 가진다. 
반면에 패킷 교환의 경우는 출력 큐의 한도를 초과하지 않는 만큼의 동시접속자 허용한다.
결론적으로 패킷 교환이 회선 교환에 비해 약 3배정도의 사용자를 가질 수 있다.
```
회선교환의 비활용 기간
전송링크 사용 할당에 request의 필요 유무(회선 교환은 요구가 필요없다. 패킷 교환은 요구가 있을 때만 링크 사용을 할당)

## 1.3.3 네트워크의 네트워크: 인터넷
목표: 모든 종단 시스템이 서로에게 패킷을 보낼 수 있도록 접속 ISP를 연결 하는 것

  네트워크 구조1
``` 모든 접속 ISP를 하나의 글로벌 transit ISP와 연결한다
글로벌 ISP는 전세계를 이르며 ISP근방에 ISP에 연결되어 있는 수십만개의 라우터가 존재  

  1. 확장 네트워크를 구축하는데 많은 비용 발생  
  2. 접속 ISP에 과금을 하는 것이 자연스러워짐 (접속ISP는 고객, 글로벌 ISP는 제공자)
  3. 회사간의 글로벌 ISP구축을 통한 경쟁이 자연스러워짐(네트워크 구조2로 진화)  
```
네트워크 구조2
``` 
수십만개의 접속 ISP와 다중 글로벌 ISP로 구성
상위층에 글로벌 통과 서비스가 있고 하위층에 접속 ISP가 있는 2계층구조이다.
전 세계의 모든 도시에 존재하는 ISP는 존재하지 않는다. 따라서 지역ISP가 존재하며 이는 1계층 ISP이다.
```
네트워크 구조3
```
ISP가 계층적으로 연결되는 구조(다중계층구조)
```
네트워크 구조4
```
네트워크 구조3 + POP + 멀티홈 + 피어링 + IXP
```
  
네트워크 구조5
```
네트워크 구조4 + 콘텐츠 제공자 네트워크
```


# 1.4 패킷 교환 네트워크에서의 지연, 손실과 처리율
## 1.4.1 채킷 교환 네트워크에서의 지연 개요
노드 처리 지연(nodal processing delay)  
- 패킷 헤더를 조사하고 그 패킷을 어디로 보낼지를 결정하는 시간  
- 패킷의 비트를 전송하면서 발생하는 패킷의 비트레벨 오류를 조사하는 데 필요한 시간과 같은 요소를 포함 할수도 있다.  

큐잉 지연(queuing delay)  
- 큐에서 링크로 전송되기를 기다리는 시간  
- 큐잉 지연길이는 큐에 저장되어 링크로 전송되기를 기다리는 다른 패킷의 수에 의해 결정된다.  

전송 지연(transmission delay)  
- 패킷의 모든 비트를 링크로 밀어내는 데 필요한 시간

전파 지연(propagation delay)  
- 링크의 처음부터 다음 라우터 까지의 전파에 필요한 시간
- 두 라우터 사이의 거리를 전파속도로 나눈것


전체 노드 지연
```
d_nodal = d_proc + d_queue + d_trans + d_prop
```


## 1.4.2 큐잉 지연과 패킷 손실
```
a:패킷이 큐에 도착하는 평균률
R: 전송률
L: 모든 패킷의 bit를  L bit라고 가정

    트래픽 강도: La/R

n번째 전송된 패킷은 (n-1)L/R초의 큐잉 지연을 겪는다
트래픽 강도가 1에 접근할 수록 평균 큐잉 지연이 급속히 증가한다.
트래픽 강도가 클수록 손실패킷의 비율이 증가한다.
```


## 1.4.3 종단간 지연
```
N-1개의 라우터
d_proc: 각 라우터와 출발지 호스트의 처리 지연은 
d_prop: 각 링크에서의 전파 지연 

        d_end-end = N(d_proc + d_trans + d_prop)
```

## 컴퓨터 네트워크에서의 처리율
```
F: 파일의 크기 F bits
T: 파일 F를 수신하는데 걸리는 시간

        평균처리율: F/T 초

서버의 처리율이 라우터의 처리율 보다 낮은 경우 병목 링크가 발생한다.
```


# 1.5 프로토콜 계층과 서비스 모델
## 1.5.1 계층구조
| 인터넷 프로토콜 스택 |
| :------------------: |
|     애플리케이션     |
|      트랜스포트      |
|       네트워크       |
|         링크         |
|         물리         |

애플리케이션 계층

- 네트워크 애플리케이션과 애플리케이션 계층 프로토콜이 있는 곳  
- 애플리케이션 계층 프로토콜은 여러 종단 시스템에 분산되어 있어서 한 종단 시스템에 있는 애플리케이션과 정보 패킷을 교환하는데 이 프로토콜을 사용한다.  
```
       애플리케이션 계층의 패킷을 메시지(message)라고한다.
```

트랜스포트 계층
- 트랜스포트 계층은 클라이언트와 서버 간에 애플리케이션 게층 메세지를 전송하는 서비스를 제공한다.
- TCP와 UDP라는 두가지 프랜스포트 프로토콜이 존재
  - TCP: 연결지향, 메세지 전달보장, 흐름제어(송,수신자의 속도일치), 혼잡제어 제공
  - UDP: 비연결형, 메세지 전달보장, 흐름제어(송,수신자의 속도일치), 혼잡제어 제공하지 않음
- 출발지 호스트에서 세그먼트와 목적지 주소를 네트워크 계층으로 전달.

```
        트랜스포트 계층의 패킷을 세그먼트(segment)라고 한다.
```

네트워크 계층
- 한 호스트에서 다른 호스트로 데이터그램을 라우팅하는 책임을 진다.(일련의 패킷 스위치를 거침)
- 목적지 호스트의 트랜스포트 계층으로 세그먼트를 운반하는 서비스 제공
- 두 가지 주요 요소
  - IP프로토콜: IP데이터그램의 필드를 정의하며 종단시스템과 라우터가 이 필드에 어떻게 동작하는지를 정의(오직 하나의 IP프로토콜이 있고 네트워크 계층을 가진 모든 인터넷요소는 IP프로토콜을 수행해야만 한다.)
  - 출발지와 목적지 사이에서 데이터그램이 이동하는 경롤 셜정하는 라우팅 프로토콜을 포함한다.
```
        네트워크 계층의 패킷을 데이터그램(datagram)이라 한다.
```

링크 계층
- 경로상의 한 노드에서 다른 노드로 패킷을 이동하기위해 네트워크 계층은 링크 게층 서비스에 의존해야한다.
- 각 노드에서 네트워크 계층은 데이터그램을 아래 링크계층으로 보내고 링크계층은 그 데이터그램을 경로상의 다음 노드에 전달한다.
- 링크 계층의 서비스는 그 링크에 채용된 프로토콜을 따르며 신뢰적인 전송을 제공한다.(TCP의 신뢰적 전달과 다름)
```
        링크 계층의 패킷을 프레임(frame)이라고 한다.
```

물리 계층
- 프레임 내부의 각 비트를 한 노드에서 다음 노드로 이동하는 것이다.
- 링크의 실제 전송매체에 의존한다.(꼬임쌍선, 광케이블 등)

## 1.5.2 캡슐화

- 라우터와 링크 계층 스위치는 둘 다 패킷 교환기다.
- 링크 계층 스위치는 1, 2계층을 구현하고 라우터는 1~3계층을 구현한다. 
    > 인터넷 라우터들이 IP프로토콜을 구현할 수 있지만 링크 계층 스위치는 구현하지 않는다.


| 캡슐화 1: APPlication -> Transport |     |                 |
| :--------------------------------- | --- | --------------- |
| 애플리케이션 계층 메세지(M)        | ->  | 트랜스포트 계층 |

| 캡슐화 2: Transport -> Network                                          |     |               |
| :---------------------------------------------------------------------- | --- | ------------- |
| 트랜스포트 계층 세그먼트: M + 트랜스포트 계층 헤더(오류 검출 비트 포함) | ->  | 네트워크 계층 |

| 캡슐화 3: Network -> Link                                                 |     |           |
| :------------------------------------------------------------------------ | --- | --------- |
| 네트워크 계층 데이터그램: 세그먼트 + 출발,목적지 종단 시스템주소 헤더정보 | ->  | 링크 계층 |

| 캡슐화 4: Link -> Physical              |     |           |
| :-------------------------------------- | --- | --------- |
| 링크계층 프레임: 데이터그램 + 헤더 정보 | ->  | 물리 계층 |


